.\" This manpage has been automatically generated by docbook2man 
.\" from a DocBook document.  This tool can be found at:
.\" <http://shell.ipoline.com/~elmert/comp/docbook2X/> 
.\" Please send any bug reports, improvements, comments, patches, 
.\" etc. to Steve Cheng <steve@ggi-project.org>.
.TH "GFARM.CONF" "5" "01 April 2008" "Gfarm" ""

.SH NAME
gfarm.conf \- Gfarm 設定ファイル
.SH "DESCRIPTION"
.PP
gfarm.conf ファイルは、gfarm プログラムの設定ファイルです。
サーバー・プロセスである gfmd と gfsd は、デフォルトでは、
この %%SYSCONFDIR%%/gfarm.conf を設定ファイルとして参照します。
なお、設定内容が読み込まれるのは起動時だけなので、
設定内容を変更した場合、サーバーを再起動する必要があります。
.PP
アプリケーションプログラムは、環境変数 GFARM_CONFIG_FILE で
指定したファイルと、%%SYSCONFDIR%%/gfarm.conf を、設定ファイル
として参照します。この二つのファイルでは、環境変数 GFARM_CONFIG_FILE で
指定したファイルの設定の方が優先されます。
どちらの設定ファイルも、同一の文法で記述します。
環境変数 GFARM_CONFIG_FILE が設定されてない場合、代わりに
ユーザーのホームディレクトリにある .gfarmrc ファイルを使用します。
.PP
gfarm.conf は、一行に一文の形式で設定します。
ただし、行末に文字 ``\\'' を記述することによって、行を継続させることが
できます。また、文字 ``#'' から行末までは、コメントとして扱われ、無視
されます。
.SH "ホスト指定"
.PP
引数として、\fIホスト指定\fR を記述できる文がいくつかありますが、
この場合、ホスト指定には、下記のいずれかを記述できます。
.TP
\fB\fIIII.JJJ.KKK.LLL\fB\fR
"." で区切られた 0〜255 までの数字 4 つで、IP アドレスを指定します。
.TP
\fB\fIIII.JJJ.KKK.LLL\fB/\fIMM\fB\fR
IP アドレスと、"/" で区切られた 0〜31 までの数字で、ネットワークを
指定します。"/" 以降の数字は netmask のビット長です。
.TP
\fB\fIdomain.name\fB\fR
ホスト名をドメイン名で指定します。
.TP
\fB \&.\fIdomain.name\fB\fR
ドメイン名の先頭が "." ではじまる場合、このドメイン名に所属する全ての
ホストを意味します。
.TP
\fB*\fR
"*" と記述されている場合、全てのホストを意味します。
.TP
\fBLISTENER\fR
sockopt 文の場合、全て大文字で "LISTENER" と記述すると、されている場合、全てのホストを意味します。
.SH "文"
.PP
文には、下記の種類があります。
.TP
\fBspool \fIgfsdスプール・ディレクトリ\fB\fR
gfsdが、gfarmファイルの実体を保持するディレクトリ名を
指定します。
ファイルシステムノードではこの設定は必須です。

例:

.nf
	spool /var/spool/gfarm
.fi
.TP
\fBspool_server_listen_address \fIIPアドレス\fB\fR
gfsdがTCPおよびUDPの要求を受け付けるIPアドレスを指定します。
省略時は、そのホストの全てのIPアドレスで受け付けます。
このオプションは、一つのノードで複数のスプールを提供する場合に、
それぞれのスプールごとに、別々のIPアドレスを使ってgfsdを起動する
ために用います。

例:

.nf
	spool_server_listen_address 192.168.121.1
.fi
.TP
\fBspool_serverport \fIgfsdポート番号\fB\fR
gfsdが利用するTCPおよびUDPポートの番号を指定します。
省略時のデフォルト・ポート番号は600番です。

例:

.nf
	spool_serverport 600
.fi
.TP
\fBspool_server_cred_type \fIcred_type\fB\fR
GSI認証において、gfsdが用いる証明書の種類を指定します。
sharedsecret 利用時には、この指定は単に無視されます。

サーバ側でこの指定を省略した場合、サーバを root 権限で起動した場合は
ホスト証明書を用います。またサーバを一般ユーザ権限で起動した場合は
ユーザ証明書を用います。このため、サービス証明書を利用する場合を
除いて、サーバ側ではこの指定を行う必要は通常ないでしょう。

クライアント側でこの指定を省略した場合、サーバがホスト証明書を利用している
と仮定してサーバ認証を行います。このためサーバをクライアントと同じユーザ
権限で起動している場合、クライアント側では、下記の一行を設定して
おく必要があります。

例:

.nf
	spool_server_cred_type self
.fi

指定可能な \fIcred_type\fR としては、
「self」、
「host」、「user」、
「mechanism-specific」があり、
spool_server_cred_service および
spool_server_cred_name と組み合わせて
下記のように用います。
.RS
.TP
\fBself\fR
そのユーザが現在所持しているユーザ証明書を用いることを示します。
この指定を利用する際には、
spool_server_cred_service および
spool_server_cred_name の
指定を行ってはいけません。
.TP
\fBhost\fR
ホスト証明書あるいはサービス証明書を用いることを示します。
サービス証明書を用いる場合、そのサービスの名前を
spool_server_cred_service で指定します。
サービス名に「host」を指定した場合、
ファイル ``\fI/etc/grid-security/hostcert.pem\fR\&'' に
あるホスト証明書を用います。
それ以外のサービス名を指定した場合、
ファイル ``\fI/etc/grid-security/サービス/サービスcert.pem\fR\&''
にあるサービス証明書を用います。
サービス名を省略した場合、「host」が指定されたとみなします。
ホスト証明書およびサービス証明書の場合、証明書の Common Name 欄のみを
比較します。Common Name は、「CN=サービス名/ホスト名」の形式である必要が
あります。また、ホスト名は、\fBgfhost\fR コマンドで指定した
正式名と正確に一致している必要があります。ホスト別名は許されません。

これは、GSSAPI (RFC2743/RFC2744) の GSS_C_NT_HOSTBASED_SERVICE に
対応する機能です。

例:

.nf
	spool_server_cred_type host
	spool_server_cred_service host
.fi
.TP
\fBuser\fR
ユーザ証明書を用いることを示します。
ユーザのアカウント名を spool_server_cred_name で指定します。
アカウント名を省略した場合には、そのコマンドを起動したユーザ名が使われます。
この指定を利用する際には、spool_server_cred_service の
指定を行ってはいけません。

現時点では、この機能の実装に、いくつかの実装上の制限事項があります。
まず、ユーザ名はローカルホストのアカウント名として解釈されますが、
これはバグであり、gfarm のグローバルユーザ名に変更される予定です。
ユーザ名と証明書の Distinguished Name の対応をとるため、
``\fI/etc/grid-security/grid-mapfile\fR\&'' を用います。
このため、このファイルが存在しなかったり、あるいはこのファイルに登録
されてないユーザは、この機能を用いることができません。
さらに、このファイル中で、同一のユーザアカウントに対して2つ以上の
Distinguished Name が設定されていた場合、2つ名以降の設定は無視されて
しまいます。

これは、GSSAPI (RFC2743/RFC2744) の GSS_C_NT_USER_NAME に対応する機能です。

例:

.nf
	spool_server_cred_type user
	spool_server_cred_name guest
.fi
.TP
\fBmechanism-specific\fR
サーバの X.509 Distinguished Name を spool_server_cred_name で
直接指定します。
この指定を利用する際には、spool_server_cred_service の
指定を行ってはいけません。

これは、GSSAPI (RFC2743/RFC2744) で Name Type として GSS_C_NO_OID を
指定した場合に対応する機能です。

例:

.nf
	spool_server_cred_type mechanism-specific
	spool_server_cred_name "/O=Grid/O=Globus/OU=example.com/CN=John Smith"
.fi
.RE
.TP
\fBspool_server_cred_service \fIcred_service\fB\fR
GSI認証において、spool_server_cred_type として
「host」を指定している場合に、gfsd が用いるサービス証明書の
種類を指定します。
sharedsecret 利用時には、この指定は単に無視されます。
詳しくは spool_server_cred_type の項を参照してください。
.TP
\fBspool_server_cred_name \fIcred_name\fB\fR
GSI認証において、spool_server_cred_type で指定した値に
応じて、gfsd が用いる証明書の設定を行います。
sharedsecret 利用時には、この指定は単に無視されます。
詳しくは spool_server_cred_type の項を参照してください。
.TP
\fBmetadb_serverhost \fIgfmdホスト名\fB\fR
gfmdが動作しているホスト名を指定します。

この設定は必須です。

例:

.nf
	metadb_serverhost ldap.example.com
.fi
.TP
\fBmetadb_serverport \fIgfmdポート番号\fB\fR
gfmdが利用するTCPポートの番号を指定します。
省略時のデフォルト・ポート番号は601番です。

例:

.nf
	metadb_serverport 601
.fi
.TP
\fBmetadb_server_cred_type \fIcred_type\fB\fR
GSI認証において、gfmd が用いる証明書の種類を指定します。
sharedsecret 利用時には、この指定は単に無視されます。
設定の意味については  spool_server_cred_type の項を
参照してください。
.TP
\fBmetadb_server_cred_service \fIcred_service\fB\fR
GSI認証において、metadb_server_cred_type として
「host」を指定している場合に、gfmd が用いるサービス証明書の
種類を指定します。
sharedsecret 利用時には、この指定は単に無視されます。
設定の意味については  spool_server_cred_type の項を
参照してください。
.TP
\fBmetadb_server_cred_name \fIcred_name\fB\fR
GSI認証において、metadb_server_cred_type で指定した値に
応じて、gfmd が用いる証明書の設定を行います。
sharedsecret 利用時には、この指定は単に無視されます。
設定の意味については  spool_server_cred_type の項を
参照してください。
.TP
\fBagent_serverhost \fIgfarm_agentホスト名\fB\fR
gfarm_agentが動作しているホスト名を指定します。

例:

.nf
	agent_serverhost ldap.example.com
.fi
.TP
\fBagent_serverport \fIgfarm_agentポート番号\fB\fR
gfarm_agentが利用するTCPポートの番号を指定します。

agent_serverhostを指定する場合には、
この設定は必須です。

例:

.nf
	agent_serverport 603
.fi
.TP
\fBldap_serverhost \fILDAPサーバー・ホスト名\fB\fR
メタデータのバックエンド・データベースとしてLDAPサーバを選択する場合、
LDAP サーバーが動作しているホスト名を指定します。

例:

.nf
	ldap_serverhost ldap.example.com
.fi
.TP
\fBldap_serverport \fILDAPサーバー・ポート番号\fB\fR
LDAP サーバーが利用するTCPポートの番号を指定します。

ldap_serverhostを指定する場合には、
この設定は必須です。

例:

.nf
	ldap_serverport 602
.fi
.TP
\fBldap_base_dn \fILDAP_base_distinguished_name\fB\fR
LDAP データベースで保持するデータのキーの根となるノードの
名称、base distinguished name を指定します。

ldap_serverhostを指定する場合には、
この設定は必須です。

例:

.nf
	ldap_base_dn "dc=example, dc=com"
.fi
.TP
\fBldap_bind_dn \fILDAP_bind_distinguished_name\fB\fR
LDAP データベースに接続する際の認証に用いる名称を、distinguished name で指定します。

例:

.nf
	ldap_bind_dn "cn=gfarmuser, dc=example, dc=com"
.fi
.TP
\fBldap_bind_password \fIpassword\fB\fR
LDAP データベースに接続する際の認証パスワードを指定します。

例:

.nf
	ldap_bind_password "secret-ldap-password"
.fi
.TP
\fBpostgresql_serverhost \fIPostgreSQLサーバー・ホスト名\fB\fR
メタデータのバックエンド・データベースとして
PostgreSQL サーバを選択する場合、
PostgreSQL サーバーが動作しているホスト名を指定します。

例:

.nf
	postgresql_serverhost postgresql.example.com
.fi
.TP
\fBpostgresql_serverport \fIPostgreSQLサーバー・ポート番号\fB\fR
PostgreSQL サーバーが利用するTCPポートの番号を指定します。

postgresql_serverhostを指定する場合には、
この設定は必須です。

例:

.nf
	postgresql_serverport 602
.fi
.TP
\fBpostgresql_dbname \fIdbname\fB\fR
PostgreSQL データベース名を指定します。

postgresql_serverhostを指定する場合には、
この設定は必須です。

例:

.nf
	postgresql_dbname gfarm
.fi
.TP
\fBpostgresql_user \fIuser\fB\fR
PostgreSQL データベースに接続するデータベース管理下のユーザ名を指定します。

例:

.nf
	postgresql_user gfarm
.fi
.TP
\fBpostgresql_password \fIpassword\fB\fR
PostgreSQL データベースに接続するデータベース管理下のユーザのパスワードを指定します。

例:

.nf
	postgresql_password "secret-postgresql-password"
.fi
.TP
\fBpostgresql_conninfo \fIconnection_info\fB\fR
PostgreSQL データベースに接続するときの接続オプションを指定します。

例:

.nf
	postgresql_conninfo "sslmode=require connect_timeout=30"
.fi
.TP
\fBauth \fI有効性\fB\~ \fI認証方法\fB\~ \fIホスト指定\fB\fR
この文は、第3引数で指定したホストとの通信に用いる認証方法を設定します。

第1引数の\fI有効性\fR部には、enable ないし disable
キーワードを指定します。
第2引数の\fI認証方法\fR部には、gsi、
gsi_auth ないし sharedsecret
キーワードを指定します。
第3引数には、\fIホスト指定\fRを記述します。

この文は複数指定可能です。各認証方法ごとに、先頭から順にホスト指定に
適合するかどうか調べ、有効であるとの指定に適合した場合、その認証方法が
利用候補になります。有効であるとの指定に適合しない場合や、あるいは
有効であるとの指定に適合するよりも前に無効であるとの指定に適合した
場合、その認証方法は、候補になりません。

この指定は、サーバー側とクライアント側の両方で解釈され、
双方ともで有効になっている認証方法のみが用いられます。

認証方法が異なるものに関しては、指定の順序は意味がありません。
複数の認証方法が候補となった場合、sharedsecret、
gsi_auth、gsi 認証の順序で試みます。

Gfarm のコンパイル時に globus とのリンクを指定しなかった場合、
GSI は利用できません。この場合、gsi および
gsi_auth 認証の指定は単に無視されます。

この設定は必須です。

制限事項:

gsi 認証と sharedsecret 認証の混在は、
基本的には不可能です。同様に gsi_auth 認証と
sharedsecret 認証の混在も、基本的には不可能です。

この理由は、gfrcmd、gfrun、gfrep や、自動複製機能を有効にした gfarmfs
(gfarmfs -N) のような gfarm クライアントが gfarm ファイルシステムノードに
アクセスした場合、その gfarm ファイルシステムノードは、さらに別の
gfarm ファイルシステムノードへアクセスするからです。
ここで、最初のファイルシステムノードへのアクセスが
sharedsecret 認証で行なわれ、さらに二番目の
ファイルシステムノードへのアクセスで gsi
(あるいは gsi_auth) 認証が要求された場合、
二番目のファイルシステムノードへのアクセスは失敗します。これは、
gfarm クライアントは最初の gfarm ファイルシステムノードへ
GSI proxy 証明書を渡してないため(これは、最初のアクセスで
gsi や gsi_auth ではなくsharedsecret が使われているからです)、
最初のファイルシステムノードは、二番目のファイルシステムノードへ渡すための
GSI proxy 証明書を所持していないからです。

逆に言うと、二番目へのアクセスで決して gsi や
gsi_auth 認証が使われないのであれば、
sharedsecret と gsi (ないし
gsi_auth) を混在させることができます。たとえば、
もしもただ一つの PCクラスタから構成されたシステムがあり、そのクラスタ内の
全てのノードが NFS でユーザのホームディレクトリを共有しており、
かつ gfarm ファイルシステムノードは、すべてそのクラスタに
所属しているとすると、クラスタ内では sharedsecret認証を
用い、クラスタ外の gfarm クライアントがクラスタ内の gfarm
ファイルシステムノードにアクセスする際には gsi
(ないし gsi_auth) 認証を使うといったことができます。
下記は、そのような構成で、クラスタが 192.168.0.0/24 というアドレスを
使っていて、クラスタ外からのアクセスには gsi 認証を
要求する場合の gfarm.conf の設定例です。

.nf
		auth enable sharedsecret 192.168.0.0/24
		auth enable gsi *
.fi

例:

.nf
	auth disable sharedsecret 192.168.0.100
	auth disable sharedsecret 192.168.0.101
	auth enable sharedsecret 192.168.0.0/24
	auth enable gsi_auth 10.0.0.0/8
	auth enable gsi *
.fi

この例では、ホスト 192.168.0.100 と 192.168.0.101 の 2 つのホストを
除いた 192.168.0.0/24 ネットワークに属すホストには 
sharedsecret と gsi の両方を、
10.0.0.0/8 ネットワークに属すホストには gsi_auth および
gsi の両方を、
それ以外の全てのホストには gsi 認証のみを試みます。
すなわち、ホスト 192.168.0.100 と 192.168.0.101 の 2 つのホストは、
gsi認証のみを試みることになります。

制限事項に記述されている理由から、この例の場合、ファイルシステム
ノードは全て、192.168.0.100 や 192.168.0.101 を除く 192.168.0.0/24 
のアドレス範囲に属す必要があることにご注意ください。
.TP
\fBnetparam \fIパラメータ\fB=\fI値\fB [\fIホスト指定\fB]\fR
ネットワーク通信に用いる各種パラメータを指定します。
パラメータには下記のものがあります。

parallel_streams。このパラメータは、通信に利用する
TCPのストリーム数を指定します。省略時は1です。
このパラメータは、TCP の通信ウィンドウが十分なサイズ
まで開かないような遠方との通信の際に、有効なことがあります。
現在、このパラメータはファイルの複製機能でのみ有効です。
現在の実装では、gfrep(1) コマンドを起動したホストのユーザー設定ファイルの
内容が用いられます。ホスト指定と比較されるのは、複製先のホストではなく、
複製元のホストです。

stripe_unit_size。このパラメータは、通信に複数の TCP ストリーム
を利用する場合に、どのように転送内容を分割するかを指定します。
もしこの指定がない場合、転送内容を単に parallel_streams 個に
分割して送信します。
これに対し、stripe_unit_size を指定した場合は、このパラメータ
で指定したバイト数を単位としてストライピングして送信します。
通常、単なる分割よりもストライピングの方が性能的に有利です。

このパラメータは、上記の parallel_streams として 1 より大きな値
を指定した通信のみで有効です。
現在、このパラメータはファイルの複製機能でのみ有効です。
現在の実装では、gfrep(1) コマンドを起動したホストのユーザー設定ファイルの
内容が用いられます。ホスト指定と比較されるのは、複製先のホストではなく、
複製元のホストです。

rate_limit。コネクション1本あたりの通信バンド幅を制限する
実験的な機能です。指定する値の単位は bps (bit per second) です。
現在、このパラメータはファイルの複製機能でのみ有効です。
現在の実装では、複製元のホスト上の gfsd の設定ファイルが用いられます。
ホスト指定と比較されるのは、複製先のホストです。

例:

.nf
	netparam parallel_streams=2	10.0.0.0/8
	netparam stripe_unit_size=8192	10.0.0.0/8
	netparam rate_limit=750000	192.168.0.0/24
.fi
.TP
\fBsockopt \fIオプション\fB[=\fI値\fB] [LISTENER | \fIホスト指定\fB]\fR
通信 socket(2) に対して、setsockopt(2) システムコールを使って
ソケット・オプションを指定します。

第2引数に全て大文字で LISTENER を指定した場合、
サーバー側 (着呼側) のソケットに指定するオプションになります。
この場合、通信する相手に関係なく、
一律にソケット・オプションが設定されます。

第2引数にホスト指定を記述した場合、クライアント側 (発呼側) の
ソケットに指定するオプションになります。この場合、通信する相手毎に
ソケット・オプションを変えることができます。
なお、第2引数に "*" と記述すると、クライアント側 (発呼側) の全ての
ホストを意味することになり、サーバー側 (着呼側) には適用されません。

第2引数を省略した場合、サーバー側とクライアント側の両方で、
全ての通信相手に対して同じソケット・オプションを設定します。

指定可能なソケット・オプションには次のものがあります。

debug。setsockopt(2) システムコールで、SO_DEBUG ソケット・オプションを指定します。値を記述する必要はありません。

keepalive。setsockopt(2) システムコールで、SO_KEEPALIVE
ソケット・オプションを指定します。値を記述する必要はありません。

sndbuf。setsockopt(2) システムコールで、SO_SNDBUF
ソケット・オプションを指定します。値の指定が必要です。

rcvbuf。setsockopt(2) システムコールで、SO_RCVBUF
ソケット・オプションを指定します。値の指定が必要です。

tcp_nodelay。setsockopt(2) システムコールで、TCP_NODELAY
ソケット・オプションを指定します。値を記述する必要はありません。

例:

.nf
	sockopt tcp_nodelay 192.168.0.0/24
	sockopt sndbuf=1048576 10.0.0.0/8
	sockopt sndbuf=1048576 LISTENER
	sockopt rcvbuf=1048576 10.0.0.0/8
	sockopt rcvbuf=1048576 LISTENER
.fi
.TP
\fBaddress_use \fIホスト指定\fB\fR
ファイルシステムノードに複数のIPアドレスがある場合、その中のどの
IPアドレスを通信に用いるかを指定します。
この文で指定したアドレスに適合するIPアドレスを優先して使用しますが、
適合するアドレスがない場合でも、通信を行います。

例:

.nf
	address_use 192.168.0.0/24
.fi
.TP
\fBclient_architecture \fIアーキテクチャ名\fB\~ \fIホスト指定\fB\fR
クライアントノードが実行ファイルにアクセスする場合に選択する
デフォルトのアーキテクチャ名を指定します。
この指定は、クライアントノードについてのみ作用します。
ファイルシステムノードについては、メタデータサーバに登録されている
アーキテクチャ名が使われます。

これに対し、環境変数 GFARM_ARCHITECTURE を使うと、クライアントノードに対しても
ファイルシステムノードについても、実行ファイルのデフォルトのアーキテクチャ名を
指定することができます。

例:

.nf
	client_architecture i386-redhat8.0-linux linux-1.example.com
	client_architecture i386-redhat8.0-linux linux-2.example.com
	client_architecture sparc-sun-solaris8 solaris-1.example.com
.fi
.TP
\fBlocal_user_map \fIユーザマップファイルパス名\fB\fR
グローバルユーザ名とローカルユーザ名の対応関係を記述した
ユーザマップファイルパス名を指定します。

この設定は必須ではありませんが、同一ユーザーに対して、
異なるアカウント名を与えているファイルシステムノードがある場合に、
このファイルでユーザー名の変換を行うことができます。そのような場合、
このファイルで、各ノードのローカルなユーザ名に対して、単一の
グローバルユーザ名を定義してやることによって、UNIX 的なアカウント名が
異なっても同一ユーザとしてgfarm を利用することができます。

例:

.nf
	local_user_map /etc/gfarm/gfarm-usermap
.fi

ユーザーマップファイルは、グローバルユーザー名と
ローカルユーザー名を、空白で区切って各行に記述します。

ユーザマップファイルの内容例:

.nf
	foobar foo
	quux baz
.fi

この例の1行目の指定では、このノードのローカルユーザ名 foo に
対してグローバルユーザ名 foobar が定義されています。
.TP
\fBidentical_user_map \fI有効性\fB\fR
enable を指定することにより、
ユーザマップファイルに対応するグローバルユーザ名がない場合に、
ローカルのアカウント名をグローバルユーザ名とします。
デフォルトは enable です。

例:

.nf
	identical_user_map disable
.fi
.TP
\fBdir_cache_timeout \fI秒数\fB\fR
gfarm ライブラリが内部的に保持している、ディレクトリキャッシュの
有効期限を秒数で指定します。デフォルトは86400秒すなわち一日です。
この値は、環境変数 GFARM_DIRCACHE_TIMEOUT でも指定することができます。
設定ファイルと環境変数では、環境変数の方が優先されます。

例:

.nf
	dir_cache_timeout 60
.fi
.TP
\fBhost_cache_timeout \fI秒数\fB\fR
gfarm ライブラリが内部的に保持している、ファイルシステムノードに
関するメタデータキャッシュの有効期限を秒数で指定します。
新たにファイルシステムノードを追加したり削除したりした場合、この期限が
切れるまでは、変更されたノードが見えないことがあります。
デフォルトは600秒すなわち10分です。

例:

.nf
	host_cache_timeout 60
.fi
.TP
\fBschedule_cache_timeout \fI秒数\fB\fR
gfarm ライブラリが内部的に保持している、ファイルシステムノード
のスケジューリング処理に関わる情報、すなわちロードアベレージ、
ディスク空き容量、認証が通るか否か等のキャッシュの有効期限を秒数で指定します。
停止していたファイルシステムノードが復活したような場合、この期限が
切れるまでは、そのノードがスケジューリングされないことがあります。
デフォルトは600秒すなわち10分です。

例:

.nf
	schedule_cache_timeout 60
.fi
.TP
\fBwrite_local_priority \fI有効性\fB\fR
gfarm は、ファイルを書き込むノードを決める際、できる限りローカル
ホストを優先するように動作します。この文で disable と指定することによって、
ローカルホストを他のホストと同様に扱うように変更することができます。
環境変数 GFARM_WRITE_LOCAL_PRIORITY に disable と設定しても、同じ意味に
なります。
両方指定した場合は、環境変数が優先されます。
デフォルトは enable です。

例:

.nf
	write_local_priority disable
.fi
.TP
\fBwrite_target_domain \fIドメイン名\fB\fR
gfarm がファイルを書き込むノードを決める際、できる限りここで
指定したドメインを優先するように動作します。
ここで指定したドメインにファイル作成可能なホストが存在しない場合や、
特にこの指定を行なわなかった場合には、全ノードが対象となります。
環境変数 GFARM_WRITE_TARGET_DOMAIN でも、同様な指定ができます。
両方指定した場合は、環境変数が優先されます。
なります。
この指定を複数回行なっても、最初の指定のみが利用され、二番目以降は
単に無視されるので注意してください。

例:

.nf
	write_target_domain example.org
.fi
.TP
\fBminimum_free_disk_space \fIバイト数\fB\fR
ファイルシステムノードで必要な最小限度のディスク空き容量を指定
します。このサイズ以下の空き容量しかないファイルシステムノードは、
ファイル書き込みを行う可能性のある操作を行う際に、選択されなくなります。
指定はバイト単位で行いますが、数字の末尾に空白を開けずに k/M/G/T を指定
することで、それぞれ 1kバイト／1Mバイト／1Gバイト／1Tバイトを単位とする
ことができます。
デフォルトは128Mバイトです。

例:

.nf
	minimum_free_disk_space 1G
.fi
.TP
\fBgfsd_connection_cache \fIコネクション数\fB\fR
gfarm ライブラリが gfsd との通信に用いるコネクションを、いくつ
までキャッシュするかを指定します。
デフォルトは16コネクションです。

例:

.nf
	gfsd_connection_cache 32
.fi
.TP
\fBlog_level \fI優先度レベル\fB\fR
どの優先度レベル以上のログを出力するかを指定します。
ここで指定したレベル未満の優先度のログは、syslog や標準エラーへ
送られません。
レベルは、優先度の高い順に "emerg", "alert", "crit", "err", "warning",
"notice", "info", "debug" です。
デフォルトの出力レベルは "info" です。
"crit" 以上の優先度を指定することは、お勧めできません。

例:

.nf
	log_level debug
.fi
.TP
\fBrecord_atime \fI有効性\fB\fR
このオプションが enable の場合、最終アクセス時刻をきちんと記録します。
disable の場合には最終アクセス時刻の記録は不正確になりますが、
メタデータ更新の負荷が下がり、性能が向上することがあります。
disable 設定は、通常のファイルシステムにおける "noatime" オプションに
相当します。

例:

.nf
	record_atime disable
.fi
.TP
\fBroot_directory_access \fI有効性\fB\fR
このオプションが disable の場合、Gfarmファイルシステムの
ルートディレクトリに対する新規ファイル、ディレクトリの作成を禁止します。

例:

.nf
	root_directory_access disable
.fi
.SH "GRAMMAR"
.PP
gfarm.conf の文法をBNFで記述すると、下記のようになります。

.nf
	<statement> ::=
		\~\~<spool_statement> |
		\~\~<spool_server_listen_address_statement> |
		\~\~<spool_serverport_statement> |
		\~\~<spool_server_cred_type_statement> |
		\~\~<spool_server_cred_service_statement> |
		\~\~<spool_server_cred_name_statement> |
		\~\~<metadb_serverhost_statement> |
		\~\~<metadb_serverport_statement> |
		\~\~<metadb_server_cred_type_statement> |
		\~\~<metadb_server_cred_service_statement> |
		\~\~<metadb_server_cred_name_statement> |
		\~\~<agent_serverhost_statement> |
		\~\~<agent_serverport_statement> |
		\~\~<ldap_serverhost_statement> |
		\~\~<ldap_serverport_statement> |
		\~\~<ldap_base_dn_statement> |
		\~\~<ldap_bind_dn_statement> |
		\~\~<ldap_bind_password_statement> |
		\~\~<postgresql_serverhost_statement> |
		\~\~<postgresql_serverport_statement> |
		\~\~<postgresql_dbname_statement> |
		\~\~<postgresql_user_statement> |
		\~\~<postgresql_password_statement> |
		\~\~<postgresql_conninfo_statement> |
		\~\~<auth_statement> |
		\~\~<netparam_statement> |
		\~\~<sockopt_statement> |
		\~\~<address_use_statement> |
		\~\~<client_architecture_statement> |
		\~\~<local_user_map_statement> |
		\~\~<identical_user_map_statement> |
		\~\~<dir_cache_timeout_statement> |
		\~\~<host_cache_timeout_statement> |
		\~\~<schedule_cache_timeout_statement> |
		\~\~<write_local_priority_statement> |
		\~\~<write_target_domain_statement> |
		\~\~<minimum_free_disk_space_statement> |
		\~\~<gfsd_connection_cache_statement> |
		\~\~<log_level_statement> |
		\~\~<record_atime_statement> |
		\~\~<root_directory_access_statement>
	<spool_statement> ::= "spool" <pathname>
	<spool_server_listen_address_statement> ::=
		\~\~"spool_server_listen_address" <ipv4_address>
	<spool_serverport_statement> ::= "spool_serverport" <hostname>
	<spool_server_cred_type_statement> ::=
		\~\~"spool_server_cred_type" <cred_type>
	<spool_server_cred_service_statement> ::=
		\~\~"spool_server_cred_service" <cred_service>
	<spool_server_cred_name_statement> ::=
		\~\~"spool_server_cred_name" <cred_name>
	<metadb_serverhost_statement> ::= "metadb_serverhost" <hostname>
	<metadb_serverport_statement> ::= "metadb_serverport" <portnumber>
	<metadb_server_cred_type_statement> ::=
		\~\~"metadb_server_cred_type" <cred_type>
	<metadb_server_cred_service_statement> ::=
		\~\~"metadb_server_cred_service" <cred_service>
	<metadb_server_cred_name_statement> ::=
		\~\~"metadb_server_cred_name" <cred_name>
	<agent_serverhost_statement> ::= "agent_serverhost" <hostname>
	<agent_serverport_statement> ::= "agent_serverport" <portnumber>
	<ldap_serverhost_statement> ::= "ldap_serverhost" <hostname>
	<ldap_serverport_statement> ::= "ldap_serverport" <portnumber>
	<ldap_base_dn_statement> ::= "ldap_base_dn" <string>
	<ldap_bind_dn_statement> ::= "ldap_bind_dn" <string>
	<ldap_bind_password_statement> ::= "ldap_bind_password" <string>
	<postgresql_serverhost_statement> ::= "postgresql_serverhost" <hostname>
	<postgresql_serverport_statement> ::= "postgresql_serverport" <portnumber>
	<postgresql_dbname_statement> ::= "postgresql_dbname" <string>
	<postgresql_user_statement> ::= "postgresql_user" <string>
	<postgresql_password_statement> ::= "postgresql_password" <string>
	<postgresql_conninfo_statement> ::= "postgresql_conninfo" <string>
	<auth_statement> ::=
		\~\~"auth" <validity> <auth_method> <hostspec>
	<auth_method> ::= "gsi" | "gsi_auth" | "sharedsecret"
	<netparam_statement> ::=
		\~\~"netparam" <netparam_option>=<number> [<hostspec>]
	<netparam_option> ::= "parallel_streams" | "stripe_unit_size" |
		\~\~"rate_limit"
	<sockopt_statement> ::=
		\~\~"sockopt" <socket_option>[=<number>] [""LISTENER" | <hostspec>]
	<socket_option> = "debug" | "keepalive" | "sndbuf" | "rcvbuf" |
		\~\~"tcp_nodelay"
	<address_use_statement> ::=  "address_use" <hostspec>
	<client_architecture_statement> ::=
		\~\~"client_architecture" <architecture> <hostspec>
	<local_user_map_statement> ::=  "local_user_map" <pathname>
	<identical_user_map_statement> ::= "identical_user_map" <validity>
	<dir_cache_timeout_statement> ::=	"dir_cache_timeout" <number>
	<host_cache_timeout_statement> ::= "host_cache_timeout" <number>
	<schedule_cache_timeout_statement> ::= "schedule_cache_timeout" <number>
	<write_local_priority_statement> ::= "write_local_priority" <validity>
	<write_target_domain_statement> ::= "write_target_domain" <string>
	<minimum_free_disk_space_statement> ::=
		\~\~"minimum_free_disk_space" <size>
	<gfsd_connection_cache_statement> ::= "gfsd_connection_cache" <number>
	<log_level_statement> ::= "log_level" <log_priority>
	<record_atime_statement> ::= "record_atime" <validity>
	<root_directory_access_statement> ::= "root_directory_access" <validity>
	<hostspec> ::= <ipv4_address> | <ipv4_address> "/" <address_mask> |
		\~\~<hostname> | "." <domain_name> | "*"
	<pathname> ::= <pathname_character> <pathname_character>*
	<pathname_character> ::= <hostname_character> | "," | "/" | "_"
	<hostname> ::= <hostname_character> <hostname_character>*
	<hostname_character> ::= <alphabet> | <digit> | "-" | "."
	<portnumber> ::= <number>
	<size> ::= <number> [ "k" | "M" | "G" | "T" ]
	<number> ::= <digit> [<digit>*]
	<digit> ::= "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"
	<string> ::= """ <double_quoted_character>* """
	<double_quoted_character> ::=
		\~\~<any_character_except_backslash_and_double_quotation> |
		\~\~"\\\\" | "\\""
	<validity> ::= "enable" | "disable"
	<log_priority> ::= "emerg" | "alert" | "crit" | "err" | "warning" |
		\~\~"notice" | "info" | "debug"
.fi
.SH "EXAMPLES"
.PP
メタデータの保存に PostgreSQL を使い、IPアドレス 192.168.0.0/24 の
ファイルシステムノードやクライアントに対して、sharedsecret 認証を
使う例です。

.nf
spool /var/spool/gfarm
spool_serverport 600
metadb_serverhost metadb.example.org
metadb_serverport 601
postgresql_serverhost metadb.example.org
postgresql_serverport 5432
postgresql_dbname gfarm
postgresql_user gfarm
postgresql_password "secret-postgresql-password"
auth enable sharedsecret 192.168.0.0/24
sockopt keepalive
.fi
.PP
メタデータの保存に LDAP を使い、任意のIPアドレスを使う
ファイルシステムノードやクライアントに対して、GSI 認証を使う例です。

.nf
spool /var/spool/gfarm
spool_serverport 600
metadb_serverhost metadb.example.com
metadb_serverport 601
ldap_serverhost metadb.example.com
ldap_serverport 389
ldap_base_dn "dc=example, dc=com"
ldap_bind_dn "cn=gfarmuser, dc=example, dc=com"
ldap_bind_password "secret-ldap-password"
auth enable gsi *
sockopt keepalive
.fi
.SH "FILES"
.TP
\fB\fI%%SYSCONFDIR%%/gfarm.conf\fB\fR
.TP
\fB\fI$HOME/.gfarmrc\fB\fR
.SH "SEE ALSO"
.PP
\fBgfmd\fR(8),
\fBgfsd\fR(8),
\fBgfarm_agent\fR(1),
\fBsetsockopt\fR(2)
